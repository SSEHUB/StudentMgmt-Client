<div id="edit-assessment-container" class="tab">

	<div id="grid">
		<div id="left">
			<h2 id="title">{{ 'Title.EditAssessment' | translate }}</h2>
				
			<p id="review-state-error" class="text-red" *ngIf="assignment?.state !== stateEnum.INREVIEW">
				<mat-icon>error</mat-icon>{{ 'Error.AssignmentNotInReview' | translate }}
			</p>

			<div class="assessment-header">
				<span class="created-by">
					{{ 'Common.CreatedBy' | translate }}
					<span class="font-bold">{{(assessment$ | async)?.creator.displayName}}</span>
					<button mat-icon-button matTooltip="Load edit history" (click)="loadAssessmentEvents()">
						<mat-icon class="icon-light">history</mat-icon>
					</button>
				</span>

				<div *ngIf="showEvents" class="events">
					<p *ngIf="events.length == 0">{{ 'Common.None' | translate }}.</p>
					<span *ngFor="let event of events">
						[{{ event.timestamp | date }}] - {{ 'Property.Assessment.AchievedPoints' | translate }}: {{ event.payload.oldScore }} -> {{ event.payload.newScore }}
					</span>
				</div>
			
				<div class="assessment-target">
					<app-assessment-target
						[group]="group"
						[targetedParticipant]="targetedParticipant"
						[participant]="participantFacade.participant$ | async"
						[courseId]="courseId"
					>
					</app-assessment-target>
				</div>
			</div>

			<app-assessment-form [assignment]="assignment" (onPartialRemoved)="addToRemovedPartials($event)"></app-assessment-form>

			<button mat-raised-button color="accent" id="btn-save" [disabled]="form.isInvalid() || assignment?.state !== stateEnum.INREVIEW" (click)="onSave()">
				{{ 'Action.Save' | translate }}
			</button>
		</div>
	
		<div id="right tab">
			<app-assessment-target-picker 
				[courseId]="courseId"  
				[assignmentId]="assignmentId" 
				(onGroupSelected)="groupSelectedHandler($event)"
				(onUserSelected)="userSelectedHandler($event)"
				(onSwitchToEdit)="switchToEdit($event)">
			</app-assessment-target-picker>
		</div>
	</div>

</div>

