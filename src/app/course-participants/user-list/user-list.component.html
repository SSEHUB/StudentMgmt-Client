<div class="tab">
	
	<div>
		<div class="filter">
			<div class="top">
				<div class="roles">
					<mat-label class="font-bold">{{ 'Property.User.CourseRole' | translate }}</mat-label>
					<mat-checkbox [(ngModel)]="filter.includeStudents" (change)="searchParticipants()">{{ 'Enum.CourseRole.STUDENT' | translate }}</mat-checkbox>
					<mat-checkbox [(ngModel)]="filter.includeTutors" (change)="searchParticipants()">{{ 'Enum.CourseRole.TUTOR' | translate }}</mat-checkbox>
					<mat-checkbox [(ngModel)]="filter.includeLecturers" (change)="searchParticipants()">{{ 'Enum.CourseRole.LECTURER' | translate }}</mat-checkbox>
				</div>
	
				<div class="right">
					<button mat-flat-button color="primary" (click)="downloadCsv()">Download CSV</button>
				</div>
			</div>
	
			<mat-form-field id="userFilter-field">
				<mat-label>{{ 'Property.User.Username' | translate }}</mat-label>
				<input matInput [(ngModel)]="filter.username" (keyup)="usernameFilterChangedSubject.next()" autocomplete="off">
			</mat-form-field>
		</div>
	</div>
	
	<div id="table-users">
		<table class="full-width" mat-table [dataSource]="dataSource$ | async">
	
			<!-- Action Column -->
			<ng-container matColumnDef="actions">
				<th class="action-column" mat-header-cell *matHeaderCellDef></th>
				<td class="action-column" mat-cell *matCellDef="let row">
					<button mat-icon-button [matMenuTriggerFor]="userOptionsMenu">
						<mat-icon class="icon-light">settings</mat-icon>
					  </button>
					  <mat-menu #userOptionsMenu="matMenu" yPosition="above">
						<button mat-menu-item (click)="openChangeRoleDialog(row)">
							<mat-icon>import_export</mat-icon>
							<span>{{ 'Action.Custom.ChangeRole' | translate }}</span>
						</button>
						<button mat-menu-item (click)="openRemoveDialog(row)">
						 <span class="text-red">
							<mat-icon>delete_forever</mat-icon>
							<span>{{ 'Action.Remove' | translate }}</span>
						 </span>
						</button>
					  </mat-menu>
				</td>
			</ng-container>

			<!-- Role Column -->
			<ng-container matColumnDef="role">
				<th class="column-role" mat-header-cell *matHeaderCellDef>{{ 'Property.User.Role' | translate }}</th>
				<td mat-cell *matCellDef="let row">{{ 'Enum.CourseRole.' + row.role | translate }}</td>
			</ng-container>
	
			<!-- Username Column -->
			<ng-container matColumnDef="username">
				<th class="column-username" mat-header-cell *matHeaderCellDef>{{ 'Property.User.Username' | translate }}</th>
				<td mat-cell *matCellDef="let row">
					<a class="link-none font-bold" [routerLink]="['/courses', courseId, 'users', row.userId]">{{ row.username }}</a>
				</td>
			</ng-container>

			<!-- DisplayName Column -->
			<ng-container matColumnDef="displayName">
				<th mat-header-cell *matHeaderCellDef>{{ 'Property.User.DisplayName' | translate }}</th>
				<td mat-cell *matCellDef="let row">
					<a class="link-none font-bold" [routerLink]="['/courses', courseId, 'users', row.userId]">{{ row.displayName }}</a>
				</td>
			</ng-container>

			<ng-container matColumnDef="spacer">
				<th mat-header-cell *matHeaderCellDef></th>
				<td mat-cell *matCellDef="let row">
				</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
		</table>
	
		<app-paginator  (onPageChanged)="searchParticipants(true)"></app-paginator>
	</div>
</div>
